---
title: "Senior Mathematics Project"
author: "Eduardo Martinez"
output:
  ioslides_presentation:
    fig_caption: yes
    fig_height: 4
    fig_width: 4
    smaller: yes
    widescreen: yes
  html_document:
    df_print: paged
    toc: yes
  html_notebook:
    code_folding: hide
    toc: yes
    toc_float: yes
Date: April 30, 2020
---

<style>
slides > slide { 
  overflow-x: auto!important; 
  overflow-y: auto!important; 
  }
</style>

<style>
.pre-scrolly {
  max-height: 150px;
  overflow-y: auto;
  max-width: 150px;
  overflow-x: auto;
  }
</style>

```{r global_options, echo = FALSE, echo = FALSE}
options(width = 150, height = 100)
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, cache = FALSE, tidy = FALSE, size = "small")
```

```{r loading packages, warning=FALSE, message=FALSE, echo=FALSE}
library(tidyverse)
library(cowplot)
library(ggpubr)
library(ggpmisc)
library(modelr)
library(forecast)
library(graphics)
```

```{r datasets, message=FALSE, warning=FALSE, echo=FALSE}
dftempconc1 <- read_csv("TempConc_Updated_04132020.csv",
                   col_types = cols(
                     .default = col_double()
                   )
                   ) %>%
  select(-c(X1, Big3_Concentration)) %>%
  select(Year:CO2_Concentration, CH4_Concentration, N2O_Concentration)

dfworld1 <- read_csv("Combined_At_1955_Updated_04132020.csv") %>%
  select(-X1) %>%
  filter(Entity == "World") %>%
  mutate(CO2_Emissions = CO2_Emissions/10000,
         N2O_Emissions = N2O_Emissions/10000,
         CH4_Emissions = CH4_Emissions/10000,
         Population = Population/100000) %>%
  select(Year, Land_Ocean_Temp, Population, CO2_Concentration, CH4_Concentration, N2O_Concentration, CO2_Emissions, CH4_Emissions, N2O_Emissions)
```

```{r factorsA, message=FALSE, warning=FALSE, echo=FALSE}
dftempconc <- dftempconc1 %>%
  mutate(
    Period = as_factor(case_when(
      Year < 1915 ~ "1880-1914",
      Year < 1950 ~ "1915-1949",
      Year < 1985 ~ "1950-1984",
      Year >= 1985 ~ "1985-2019"
      )),
    Temperature = as_factor(case_when(
      Land_Ocean_Temp < quantile(Land_Ocean_Temp, probs = 0.25, na.rm = TRUE)  ~ "13.45-13.71",
      Land_Ocean_Temp < quantile(Land_Ocean_Temp, probs = 0.5, na.rm = TRUE) ~ "13.72-13.87",
      Land_Ocean_Temp < quantile(Land_Ocean_Temp, probs = 0.75, na.rm = TRUE) ~ "13.88-14.17",
      Land_Ocean_Temp >= quantile(Land_Ocean_Temp, probs = 0.75, na.rm = TRUE) ~ "14.18-14.89"
      )),
    CO2_Conclevel = as_factor(case_when(
      CO2_Concentration < quantile(CO2_Concentration, probs = 0.25, na.rm = TRUE) ~ "287-306",
      CO2_Concentration < quantile(CO2_Concentration, probs = 0.5, na.rm = TRUE) ~ "306-318",
      CO2_Concentration < quantile(CO2_Concentration, probs = 0.75, na.rm = TRUE) ~ "318-354",
      CO2_Concentration >= quantile(CO2_Concentration, probs = 0.75, na.rm = TRUE) ~ "354-409"
      )),
    CH4_Conclevel = as_factor(case_when(
      CH4_Concentration < quantile(CH4_Concentration, probs = 0.25, na.rm = TRUE) ~ "13.45-13.71",
      CH4_Concentration < quantile(CH4_Concentration, probs = 0.5, na.rm = TRUE) ~ "13.72-13.87",
      CH4_Concentration < quantile(CH4_Concentration, probs = 0.75, na.rm = TRUE) ~ "13.88-14.17",
      CH4_Concentration >= quantile(CH4_Concentration, probs = 0.75, na.rm = TRUE) ~ "14.18-13.89"
      )),
    N2O_Conclevel = as_factor(case_when(
      N2O_Concentration < quantile(N2O_Concentration, probs = 0.25, na.rm = TRUE) ~ "13.45-13.71",
      N2O_Concentration < quantile(N2O_Concentration, probs = 0.5, na.rm = TRUE) ~ "13.72-13.87",
      N2O_Concentration < quantile(N2O_Concentration, probs = 0.75, na.rm = TRUE) ~ "13.88-14.17",
      N2O_Concentration >= quantile(N2O_Concentration, probs = 0.75, na.rm = TRUE) ~ "14.18-13.89"
      ))
    ) 

# dftempconc
dftempconc2 <- filter(dftempconc, Year <= 2018)
dftempconc3 <- filter(dftempconc, Year <= 2016)

yearint <- tibble(Year = dftempconc$Year)
yearint2 <- tibble(Year = dftempconc2$Year)
yearint3 <- tibble(Year = dftempconc3$Year)

co2concint <- tibble(CO2_Concentration = dftempconc2$CO2_Concentration)
ch4concint <- tibble(CH4_Concentration = dftempconc2$CH4_Concentration)
n2oconcint <- tibble(N2O_Concentration = dftempconc3$N2O_Concentration)
```

```{r factorsB, message=FALSE, warning=FALSE, echo=FALSE}
dfworld <- dfworld1 %>%
  mutate(
    Period = as_factor(case_when(
      Year < 1970 ~ "1955-1969",
      Year < 1986 ~ "1970-1985",
      Year < 2002 ~ "1986-2001",
      Year >= 2002 ~ "2002-2019"
      )),
    Temperature = as_factor(case_when(
      Land_Ocean_Temp < quantile(Land_Ocean_Temp, probs = 0.25, na.rm = TRUE)  ~ "13.72-13.98",
      Land_Ocean_Temp < quantile(Land_Ocean_Temp, probs = 0.5, na.rm = TRUE) ~ "13.99-14.17",
      Land_Ocean_Temp < quantile(Land_Ocean_Temp, probs = 0.75, na.rm = TRUE) ~ "14.18-14.46",
      Land_Ocean_Temp >= quantile(Land_Ocean_Temp, probs = 0.75, na.rm = TRUE) ~ "14.47-14.89"
      )),
    Poplevel = as_factor(case_when(
      Population < quantile(Population, probs = 0.25, na.rm = TRUE)  ~ "2.7-3.7",
      Population < quantile(Population, probs = 0.5, na.rm = TRUE) ~ "3.7-5.0",
      Population < quantile(Population, probs = 0.75, na.rm = TRUE) ~ "5.0-6.3.",
      Population >= quantile(Population, probs = 0.75, na.rm = TRUE) ~ "6.3-7.6"
      )),
    CO2_Conclevel = as_factor(case_when(
      CO2_Concentration < quantile(CO2_Concentration, probs = 0.25, na.rm = TRUE) ~ "314-326",
      CO2_Concentration < quantile(CO2_Concentration, probs = 0.5, na.rm = TRUE) ~ "326-347",
      CO2_Concentration < quantile(CO2_Concentration, probs = 0.75, na.rm = TRUE) ~ "347-372",
      CO2_Concentration >= quantile(CO2_Concentration, probs = 0.75, na.rm = TRUE) ~ "372-407"
      )),
    CH4_Conclevel = as_factor(case_when(
      CH4_Concentration < quantile(CH4_Concentration, probs = 0.25, na.rm = TRUE) ~ "1207-1635",
      CH4_Concentration < quantile(CH4_Concentration, probs = 0.5, na.rm = TRUE) ~ "1635-1747",
      CH4_Concentration < quantile(CH4_Concentration, probs = 0.75, na.rm = TRUE) ~ "1747-1777",
      CH4_Concentration >= quantile(CH4_Concentration, probs = 0.75, na.rm = TRUE) ~ "1777-1850"
      )),
    N2O_Conclevel = as_factor(case_when(
      N2O_Concentration < quantile(N2O_Concentration, probs = 0.25, na.rm = TRUE) ~ "290-304",
      N2O_Concentration < quantile(N2O_Concentration, probs = 0.5, na.rm = TRUE) ~ "304-311",
      N2O_Concentration < quantile(N2O_Concentration, probs = 0.75, na.rm = TRUE) ~ "311-320",
      N2O_Concentration >= quantile(N2O_Concentration, probs = 0.75, na.rm = TRUE) ~ "320-330"
      )),
    CO2_Emisslevel = as_factor(case_when(
      CO2_Emissions < quantile(CO2_Emissions, probs = 0.25, na.rm = TRUE) ~ "72-151",
      CO2_Emissions < quantile(CO2_Emissions, probs = 0.5, na.rm = TRUE) ~ "151-204",
      CO2_Emissions < quantile(CO2_Emissions, probs = 0.75, na.rm = TRUE) ~ "204-253",
      CO2_Emissions >= quantile(CO2_Emissions, probs = 0.75, na.rm = TRUE) ~ "253-362"
      )),
    CH4_Emisslevel = as_factor(case_when(
      CH4_Emissions < quantile(CH4_Emissions, probs = 0.25, na.rm = TRUE) ~ "51-60",
      CH4_Emissions < quantile(CH4_Emissions, probs = 0.5, na.rm = TRUE) ~ "60-65",
      CH4_Emissions < quantile(CH4_Emissions, probs = 0.75, na.rm = TRUE) ~ "65-69",
      CH4_Emissions >= quantile(CH4_Emissions, probs = 0.75, na.rm = TRUE) ~ "69-80"
      )),
    N2O_Emisslevel = as_factor(case_when(
      N2O_Emissions < quantile(N2O_Emissions, probs = 0.25, na.rm = TRUE) ~ "21-27",
      N2O_Emissions < quantile(N2O_Emissions, probs = 0.5, na.rm = TRUE) ~ "27-28.5",
      N2O_Emissions < quantile(N2O_Emissions, probs = 0.75, na.rm = TRUE) ~ "28.5-30",
      N2O_Emissions >= quantile(N2O_Emissions, probs = 0.75, na.rm = TRUE) ~ "30-33"
      ))
    ) 
```

```{r factorsC, message=FALSE, warning=FALSE, echo=FALSE}
# dfworld
dfworld2a <- filter(dfworld, Year >= 1970 & Year <= 2012)
dfworld2 <- dfworld2a %>%
  mutate(
    Period = as_factor(case_when(
      Year < 1980 ~ "1970-1979",
      Year < 1991 ~ "1980-1990",
      Year < 2002 ~ "1991-2001",
      Year >= 2002 ~ "2002-2012"
      )),
    Temperature = as_factor(case_when(
      Land_Ocean_Temp < quantile(Land_Ocean_Temp, probs = 0.25, na.rm = TRUE)  ~ "13.83-14.09",
      Land_Ocean_Temp < quantile(Land_Ocean_Temp, probs = 0.5, na.rm = TRUE) ~ "14.1-14.25",
      Land_Ocean_Temp < quantile(Land_Ocean_Temp, probs = 0.75, na.rm = TRUE) ~ "14.26-14.46",
      Land_Ocean_Temp >= quantile(Land_Ocean_Temp, probs = 0.75, na.rm = TRUE) ~ "14.47-14.62"
      )),
    Poplevel = as_factor(case_when(
      Population < quantile(Population, probs = 0.25, na.rm = TRUE)  ~ "3.7-4.5",
      Population < quantile(Population, probs = 0.5, na.rm = TRUE) ~ "4.5-5.4",
      Population < quantile(Population, probs = 0.75, na.rm = TRUE) ~ "5.4-6.3.",
      Population >= quantile(Population, probs = 0.75, na.rm = TRUE) ~ "6.3-7.2"
      )),
    CO2_Conclevel = as_factor(case_when(
      CO2_Concentration < quantile(CO2_Concentration, probs = 0.25, na.rm = TRUE) ~ "325-339",
      CO2_Concentration < quantile(CO2_Concentration, probs = 0.5, na.rm = TRUE) ~ "339-355",
      CO2_Concentration < quantile(CO2_Concentration, probs = 0.75, na.rm = TRUE) ~ "356-372",
      CO2_Concentration >= quantile(CO2_Concentration, probs = 0.75, na.rm = TRUE) ~ "372-394"
      )),
    CH4_Conclevel = as_factor(case_when(
      CH4_Concentration < quantile(CH4_Concentration, probs = 0.25, na.rm = TRUE) ~ "1403-1652",
      CH4_Concentration < quantile(CH4_Concentration, probs = 0.5, na.rm = TRUE) ~ "1652-1742",
      CH4_Concentration < quantile(CH4_Concentration, probs = 0.75, na.rm = TRUE) ~ "1742-1775",
      CH4_Concentration >= quantile(CH4_Concentration, probs = 0.75, na.rm = TRUE) ~ "1775-1810"
      )),
    N2O_Conclevel = as_factor(case_when(
      N2O_Concentration < quantile(N2O_Concentration, probs = 0.25, na.rm = TRUE) ~ "295-304.5",
      N2O_Concentration < quantile(N2O_Concentration, probs = 0.5, na.rm = TRUE) ~ "304.5-311",
      N2O_Concentration < quantile(N2O_Concentration, probs = 0.75, na.rm = TRUE) ~ "311-318",
      N2O_Concentration >= quantile(N2O_Concentration, probs = 0.75, na.rm = TRUE) ~ "318-325"
      )),
    CO2_Emisslevel = as_factor(case_when(
      CO2_Emissions < quantile(CO2_Emissions, probs = 0.25, na.rm = TRUE) ~ "148-187",
      CO2_Emissions < quantile(CO2_Emissions, probs = 0.5, na.rm = TRUE) ~ "187-222",
      CO2_Emissions < quantile(CO2_Emissions, probs = 0.75, na.rm = TRUE) ~ "222-253",
      CO2_Emissions >= quantile(CO2_Emissions, probs = 0.75, na.rm = TRUE) ~ "253-349"
      ))
    )

yearintw <- tibble(Year = dfworld$Year)
yearintw2 <- tibble(Year = dfworld2$Year)

popint <- tibble(Population = dfworld$Population)
popint2 <- tibble(Population = dfworld2$Population)

co2emissint <- tibble(CO2_Emissions = dfworld$CO2_Emissions)
ch4emissint <- tibble(CH4_Emissions = dfworld2$CH4_Emissions)
n2oemissint <- tibble(N2O_Emissions = dfworld2$N2O_Emissions)
```



# Statistical Analysis of Global Warming and Greenhouse Gases | By Eduardo Martinez


# Introduction

## Global Warming Background (EPA)
<div class="DarkMagenta"> 
- Earth absorbs energy from the sun and emits some back as heat
- This exchange of energy determines Earth's temperature
- Exchange is typically stable 
- If unstable, there will be a heating or cooling effect
</div>
<center>
![](overview-warming.jpeg) 
</center>

## The Greenhouse Effect (EPA) {.smaller}
<div class="blue"> 
- Radiating forces
- Greenhouse gases (GHGs) are positive radiating forces
- GHGs can persist for a long time
- Humans have caused an increase in GHG concentration
- Carbon Dioxide (CO2), Nitrous Oxide (N2O), and Methane (CH4) 
</div> 
<center>
![](2018GreenhouseEffect.png)

</center>

## Consequences of Global Warming (IPCC) {.smaller}
<div style="margin-right:0px; margin-left:0px; margin-top:-25px;">
<div class="green"> 
- Ecological, physical and health consequences
    - Extreme weather (e.g., floods, storms, heatwaves, and droughts)
    - Rising sea-levels
    - Constrained crop growth
</div> 
<div class="red"> 
- If average global temperatures increased by <strong>2.0°C</strong>:
    - 37% will experience severe heatwaves at least once every 5 years
    - 70+% of coastline sea-level will rise by >0.66 feet (0.2 meters)
    - Coral reefs will become virtually non-existent
    - 18% of insects, 8% of vertebrates, and 16% of plants will lose >50% of their geographical range
</div> 
<center>
![](global-warming.jpeg)
</center>
</div> 


# Study Background

## Emissions Data
<div class="red"> 
- CO2 Emissions (1955-2017) in 100 million tonnes per year
    - Measures annual territorial emissions from fossil fuels and cement
    - Source: Global Carbon Project & Carbon Dioxide Information Analysis Centre (CDIAC)  
</div> 
<div class="SlateGrey"> 
- CH4 and N2O Emissions (1970-2012) in 100 million tonnes of carbon dioxide equivalents (tCO₂e)
    - CH4 measures emissions from human activities such as agriculture and from industrial production
    - N2O emissions from agricultural biomass burning, industrial activities, and livestock
    - Source: Emission Database for Global Atmospheric Research (EDGAR)
</div> 

## Atmospheric Concentration Data
<div class="Maroon"> 
- CO2 Global Annual Average Atmospheric Concentration (1880-2018)
    - Measured in parts per million (ppm).
    - Source: The NOAA Earth System Research Laboratories (ESRL)
</div> 
<div class="green2">
- CH4 Global Annual Average Atmospheric Concentration (1880-2018)
    - Measured in parts per billion (ppb).
    - Source: EEA & NOAA
</div> 
<div class="blue"> 
- Nitrous Oxide (N2O) Average Atmospheric Concentration (1880-2016) 
    - Measured in parts per billion (ppb).
    - Source: European Environment Agency's (EEA) Advanced Global Atmospheric Gases Experiment (AGAGE)
</div> 
<div class="black"> 
- $1\ ppm = 1,000\ ppb$
</div>

## Temperature Data
<div class="blue"> 
- Land-Ocean Temperature (°C) (1880-2019)
    - Calculated via anomally data that used a baseline temperature of 13.9, which was the average from 1901-2000
    - Source: National Oceanic and Atmospheric Administration (NOAA)
</div> 
<center>
![](anomally_pic.png)
</center>

## Methods 
<div class="Chocolate"> 
- Linear Regression Modeling using R Programming Language (RStudio)    
</div> 
<div class="SlateGrey">
- Research Questions: 
    - How have gas emissions, concentration, temperatures, and the population changed over time?
    - Are gas emissions, concentrations, and the population related to temperature?
    - Will global temperatures increase in the future? If so, by how much
</div> 

## How to Interpret Linear Regression Results:
<div class="green"> 
- Equation of the Regression Line: $y = a + bX$ 
    - $y$ = estimated value of DV, $a$ = y-intercept, $b$ = slope, and $X$ = value on the IV.
</div> 
<div class="black"> 
- 95% Prediction Interval: $\hat{y} - E < y < \hat{y} + E$
</div> 
<div class="red"> 
- Coefficient of Determinism: $R^{2} = \frac{explained\ variation}{total\ variation}$ 
    - Values range from 0 to 1
</div> 
<div class="blue"> 
- $p$-$value$ 
    - I used a $0.05$ significance level. 
    - $p < 0.05$ suggests there is a linear correlation.
    - The majority models were significant
</div> 


# Results


# Temperature VS Year By Gas Concentrations (1880-2019) {.flexbox .centered}

--- 

```{r temps lm, warning=FALSE, message=FALSE, echo=FALSE}
tempyear_lm <- lm(Land_Ocean_Temp ~ Year, data = dftempconc, na.action = na.exclude)

tempintpreds <- as_tibble(predict(tempyear_lm, newdata=yearint, interval="predict", level=0.95)) %>%
  mutate(Year = yearint$Year) %>%
  select(Year, everything())
```

<div style="margin-top:-25px;">
<div class="center">
```{r temps VS years by co2, warning=FALSE, message=FALSE, fig.width=10, fig.height=5.5, fig.align="center", echo=FALSE}
tempyearco2 <- dftempconc %>%
  ggplot(aes(x = Year, y = Land_Ocean_Temp)) +
  ggtitle("Temperature VS Year By CO2 Concentration (1880-2019)") +
  scale_x_continuous(limits=c(1880,2019), breaks = seq(1880, 2020, 20)) +
  scale_y_continuous(limits = c(13.11, 14.9), breaks = seq(13.2, 15, 0.4)) +
  ylab("Land-Ocean Temperature (°C)") +
  geom_smooth(method="lm", color="black", size=1, linetype=2, se=FALSE) +
  geom_ribbon(aes(ymin=tempintpreds$lwr, ymax=tempintpreds$upr), fill="darkgrey", alpha=0.2) +
  geom_point(aes(color=CO2_Concentration), size=5) +
  scale_color_gradient(limits=c(287, 409), breaks = c(300, 350, 400), low = "yellow", high = "red", na.value="grey", name = "Concentration (ppm)") +
  stat_regline_equation(aes(label =  paste(..eq.label..)),
                        color="red3", label.x = 1881, label.y = 14.66, size=5) +
  stat_regline_equation(aes(label =  paste(..rr.label..)),
                        color="red3", label.x = 1881, label.y = 14.51, size=5) +
  stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
                  aes(label = paste("p = ", signif(..p.value.., digits=3), sep = "")),
                  color="red3", size=5, label.x = 0.052, label.y = 0.68) +
  theme_bw() +
  theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"), 
        axis.title = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 11),
        legend.key.height = unit(1, "cm"),
        legend.title = element_text(size=10, face="bold", hjust = 0.5),
        legend.text = element_text(size=10),
        legend.position = "right")
tempyearco2
```

</div>
</div>

--- 

```{r temps VS years by ch4, warning=FALSE, message=FALSE, fig.align="center", echo=FALSE}
tempyearch4 <- dftempconc %>%
  ggplot(aes(x = Year, y = Land_Ocean_Temp)) +
  ggtitle("Temperature VS Year By CH4 Concentration (1880-2019)") +
  scale_x_continuous(limits=c(1880,2019), breaks = seq(1880, 2020, 20)) +
  scale_y_continuous(limits = c(13.11, 14.9), breaks = seq(13.2, 15, 0.4)) +
  ylab("Land-Ocean Temperature (°C)") +
  geom_smooth(method="lm", color="black", size=1, linetype=2, se=FALSE) +
  geom_ribbon(aes(ymin=tempintpreds$lwr, ymax=tempintpreds$upr), fill="darkgrey", alpha=0.2) +
  geom_point(aes(color=CH4_Concentration), size=5) +
  scale_color_gradient(limits=c(847, 1858), breaks = c(1000, 1250, 1500, 1750), low = "yellow", high = "red", na.value = "grey", name = "Conc (ppb)") +
  theme_bw() +
  theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"), 
        axis.title = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 11),
        legend.key.width = unit(0.8, "cm"),
        legend.title = element_text(size=10, face="bold", hjust = 0.5),
        legend.text = element_text(size=10),
        legend.background = element_rect(color="black"),
        legend.direction = "horizontal",
        legend.position = c(0.7, 0.1))
```

```{r temps VS year by n2o, warning=FALSE, message=FALSE, fig.width=10, fig.height=5.5, fig.align="center", echo=FALSE}
tempyearn2o <- dftempconc %>%
  ggplot(aes(x = Year, y = Land_Ocean_Temp)) +
  ggtitle("Temperature VS Year By N2O Concentration (1880-2019)") +
  scale_x_continuous(limits=c(1880,2019), breaks = seq(1880, 2020, 20)) +
  scale_y_continuous(limits = c(13.11, 14.9), breaks = seq(13.2, 15, 0.4)) +
  ylab("Land-Ocean Temperature (°C)") +
  geom_smooth(method="lm", color="black", size=1, linetype=2, se=FALSE) +
  geom_ribbon(aes(ymin=tempintpreds$lwr, ymax=tempintpreds$upr), fill="darkgrey", alpha=0.2) +
  geom_point(aes(color=N2O_Concentration), size=5) +
  scale_color_gradient(limits=c(278, 330), breaks = c(280, 300, 320), low = "yellow", high = "red", na.value = "grey", name = "Conc (ppb)") +
  theme_bw() +
  theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"), 
        axis.title = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 11),
        legend.key.width = unit(0.8, "cm"),
        legend.title = element_text(size=10, face="bold", hjust = 0.5),
        legend.text = element_text(size=10),
        legend.background = element_rect(color="black"),
        legend.direction = "horizontal",
        legend.position = c(0.7, 0.1))
```

<div style="margin-left:-50px; margin-right:-50px;">
<div class="center">
```{r temps VS year by ch4 and n2o, warning=FALSE, message=FALSE, echo=FALSE, fig.align="center", fig.height=4.8, fig.width=11}
plot_grid(tempyearch4, tempyearn2o, ncol=2)
```

</div>
</div>


# Concentrations  {.flexbox .vcenter}

--- 

```{r conc vs year lm,  warning=FALSE, message=FALSE, echo=FALSE}
co2concyearlm <- lm(CO2_Concentration ~ Year, data = dftempconc2, na.action = na.exclude)
co2concyearpreds <- as_tibble(predict(co2concyearlm, newdata=yearint2, interval="predict", level=0.95)) %>%
  mutate(Year = yearint2$Year) %>%
  select(Year, everything())

ch4concyearlm <- lm(CH4_Concentration ~ Year, data = dftempconc2, na.action = na.exclude)
ch4concyearpreds <- as_tibble(predict(ch4concyearlm, newdata=yearint2, interval="predict", level=0.95)) %>%
  mutate(Year = yearint2$Year) %>%
  select(Year, everything())

n2oconcyearlm <- lm(N2O_Concentration ~ Year, data = dftempconc3, na.action = na.exclude)
n2oconcyearpreds <- as_tibble(predict(n2oconcyearlm, newdata=yearint3, interval="predict", level=0.95)) %>%
  mutate(Year = yearint3$Year) %>%
  select(Year, everything())
```

```{r co2 conc by year, message=FALSE, warning=FALSE, echo=FALSE}
CO2concyear_plot <- dftempconc2 %>%
  ggplot(aes(x = Year, y = CO2_Concentration), na.rm=TRUE) +
  ggtitle("CO2 Concentration VS Year by Temperature (1880-2018)") +
  scale_x_continuous(limits = c(1880,2018), breaks = seq(1880, 2020, 20)) +
  scale_y_continuous(limits = c(244,409), breaks = seq(250, 410, 40)) +
  ylab("CO2 Concentration ppm)") +
  geom_ribbon(aes(ymin=co2concyearpreds$lwr, ymax=co2concyearpreds$upr), fill="grey", alpha=0.2) +
  geom_point(aes(y=CO2_Concentration[c(TRUE, NA)], color=Temperature), size=3) +
  scale_color_manual(values=c("blue", "green3", "yellow", "red"), name = "Temp (°C)")  +
  geom_smooth(method="lm", color="black", size=1, linetype=2, se=FALSE) +
  #scale_color_gradient(limits=c(13.44,14.9), breaks = c(13.5, 14, 14.5), low = "yellow", high = "red", name = "Temperature (°C)") +
  stat_regline_equation(aes(label=paste(..eq.label..)), 
                        color="red", size=4, label.x = 1881, label.y = 395.5) +
  stat_regline_equation(aes(label=paste(..rr.label..)), 
                        color="red", size=4, label.x = 1881, label.y = 380.5) +
  stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
                  aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
                  color="red", size=4, label.x = 0.052, label.y = 0.7) +
  theme_bw() +
  theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
        axis.title = element_text(size = 10, face="bold"),
        axis.text = element_text(size = 10),
        legend.key.height = unit(1, "cm"),
        legend.title = element_text(size=12, face="bold", hjust = 0.5),
        legend.justification = "bottom",
        legend.text = element_text(size=13),
        legend.background = element_rect(color="black"),
        legend.box = "vertical", 
        legend.position = "right")
```

```{r ch4 conc by year, message=FALSE, warning=FALSE, echo=FALSE}
CH4concyear_plot <- dftempconc2 %>%
  ggplot(aes(x = Year, y = CH4_Concentration), na.rm=TRUE) +
  ggtitle("CH4 Concentration VS Year by Temperature (1880-2018)") +
  scale_x_continuous(limits = c(1880,2018), breaks = seq(1880, 2020, 20)) +
  scale_y_continuous(limits = c(558.5,2020.6), breaks = seq(700, 2000, 300)) +
  ylab("CH4 Concentration (ppb)") +
  geom_ribbon(aes(ymin=ch4concyearpreds$lwr, ymax=ch4concyearpreds$upr), fill="grey", alpha=0.2) +
  geom_point(aes(color=Temperature), size=3) +
  scale_color_manual(values=c("blue", "green3", "yellow", "red"), name = "Temp (°C)")  +
  geom_smooth(method="lm", color="black", size=1, linetype=2, se=FALSE) +
  stat_regline_equation(aes(label =  paste(..eq.label..)), 
                        color="green4", size=4, label.x = 1881, label.y = 1950) +
  stat_regline_equation(aes(label =  paste(..rr.label..)),
                        color="green4", size=4, label.x = 1881, label.y = 1826) +
  stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
                  aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
                  color="green4", size=4, label.x = 0.0524, label.y = 0.75) +
  theme_bw() +
  theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
        axis.title = element_text(size = 10, face="bold"),
        axis.text = element_text(size = 10),
        legend.position="none")
```

```{r n2o conc by year, message=FALSE, warning=FALSE, echo=FALSE}
N2Oconcyear_plot <- dftempconc3 %>%
  ggplot(aes(x = Year, y = N2O_Concentration), na.rm=TRUE) +
  ggtitle("N2O Concentration VS Year by Temperature (1880-2016)") +
  scale_x_continuous(limits = c(1880,2018), breaks = seq(1880, 2020, 20)) +
  scale_y_continuous(limits = c(257.1,331), breaks = seq(270, 330, 20)) +
  ylab("N2O Concentration (ppb)") +
  geom_ribbon(aes(ymin=n2oconcyearpreds$lwr, ymax=n2oconcyearpreds$upr), fill="grey", alpha=0.2) +
  geom_point(aes(color=Temperature), size=3) +
  scale_color_manual(values=c("blue", "green3", "yellow", "red"), name = "Temp (°C)")  +
  geom_smooth(method="lm", color="black", size=1, linetype=2, se=FALSE) +
  stat_regline_equation(aes(label =  paste(..eq.label..)),
                        color="blue", size=4, label.x = 1882, label.y = 323) +
  stat_regline_equation(aes(label =  paste(..rr.label..)),
                        color="blue", size=4, label.x = 1882, label.y = 315.1) +
  stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc", 
                  aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
                  color="blue", size=4, label.x = 0.0616, label.y = 0.68) +
  theme_bw() +
  theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
        axis.title = element_text(size = 10, face="bold"),
        axis.text = element_text(size = 10),
        legend.position="none")
```

```{r conc vs year subcowplots, warning=FALSE, message=FALSE, echo=FALSE}
conctop <- plot_grid(NULL, CO2concyear_plot, NULL, rel_widths = c(1, 4, 1), ncol=3)
concbottom <- plot_grid(CH4concyear_plot, N2Oconcyear_plot)
```

<div style="margin-right:-50px; margin-left:-50px; margin-top:-50px;">
<div class="center">
```{r conc vs year plot, warning=FALSE, message=FALSE, echo=FALSE, fig.align="center", fig.height=7, fig.width=10.5}
plot_grid(conctop, concbottom, nrow = 2)
```

</div>
</div>


# Population VS Year {.flexbox .centered}

--- 

```{r pop vs year lm,  warning=FALSE, message=FALSE, echo=FALSE}
popyearlm <- lm(Population ~ Year, data = dfworld)
popyearpreds <- as_tibble(predict(popyearlm, newdata=yearintw, interval="predict", level=0.95)) %>%
  mutate(Year = yearintw$Year) %>%
  select(Year, everything())
```

<div class="center">
<div style="margin-top:-25px;">
```{r pop vs year plot, fig.width=10, fig.height=5.5, fig.align="center", message=FALSE, warning=FALSE, echo=FALSE}
popyearplot <- dfworld %>%
  ggplot(aes(x = Year, y = Population)) +
  ggtitle("Population VS Year By Temperature (1955-2017)") +
  #geom_smooth(method="lm", color="black", size=1, linetyoe=2, se=FALSE) +
  #geom_ribbon(aes(ymin = popyearpreds$lwr, ymax = popyearpreds$upr), fill="violetred", alpha=0.2) +
  scale_x_continuous(limits = c(1955,2017), breaks = seq(1955, 2015, 10)) +
  xlab("Year") +
  scale_y_continuous(limits=c(2.25,7.75), breaks = seq(2.5, 7.5, 0.5)) +
  ylab("Population in Billions") +
  geom_point(aes(color=Temperature), size=4) +
  scale_color_manual(values=c("blue", "green3", "yellow", "red"), name = "Temp (°C)") +
  stat_regline_equation(aes(label =  paste(..eq.label..)),
                        color="violetred", label.x = 1955.5, label.y = 7.2, size=5) +
  stat_regline_equation(aes(label =  paste(..rr.label..)),
                        color="violetred", label.x = 1955.5, label.y = 6.76, size=5) +
  stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
                  aes(label = paste("p = ", signif(..p.value.., digits=3), sep = "")),
                  color="violetred", size=5, label.x = 0.053, label.y = 0.72) +
  theme_bw() +
  theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"), 
        axis.title = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 11),
        legend.key.height = unit(1, "cm"),
        legend.title = element_text(size=10, face="bold", hjust = 0.5),
        legend.justification = "center",
        legend.text = element_text(size=10),
        legend.background = element_rect(color="black"),
        legend.box = "vertical", 
        legend.position = c(0.85, 0.25),
        panel.grid.minor=element_blank())
popyearplot
```

</div>
</div>


# Emissions  {.flexbox .vcenter}

--- 

```{r emiss vs year lm,  warning=FALSE, message=FALSE, echo=TRUE}
co2emissyearlm <- lm(CO2_Emissions ~ Year, data = dfworld, na.action = na.exclude)
co2emissyearpreds <- as_tibble(predict(co2emissyearlm, newdata=yearintw, interval="predict", level=0.95)) %>%
  mutate(Year = yearintw$Year) %>%
  select(Year, everything())

ch4emissyearlm <- lm(CH4_Emissions ~ Year, data = dfworld2, na.action = na.exclude)
ch4emissyearpreds <- as_tibble(predict(ch4emissyearlm, newdata=yearintw2, interval="predict", level=0.95)) %>%
  mutate(Year = yearintw2$Year) %>%
  select(Year, everything())

n2oemissyearlm <- lm(N2O_Emissions ~ Year, data = dfworld2, na.action = na.exclude)
n2oemissyearpreds <- as_tibble(predict(n2oemissyearlm, newdata=yearintw2, interval="predict", level=0.95)) %>%
  mutate(Year = yearintw2$Year) %>%
  select(Year, everything())
``` 

--- 

```{r co2 emiss by year, message=FALSE, warning=FALSE, echo=TRUE}
CO2emissionsyear_plot <- dfworld %>%
  ggplot(aes(x = Year, y = CO2_Emissions), na.rm=TRUE) +
  ggtitle("CO2 Emissions VS Year (1955-2017)") +
  scale_x_continuous(limits = c(1955,2017), breaks = seq(1955, 2015, 10)) +
  scale_y_continuous(limits = c(43,378), breaks = seq(50, 400, 100)) +
  ylab("CO2 Emissions (100 m. tCO2e)") +
  geom_ribbon(aes(ymin=co2emissyearpreds$lwr, ymax=co2emissyearpreds$upr), fill="darkgrey", alpha=0.2) +
  geom_point(aes(y=CO2_Emissions[c(TRUE, rep(c(NA, TRUE), 30), NA, TRUE)], color=Temperature, shape=CO2_Conclevel), size=5) +
  scale_color_manual(values=c("blue", "green3", "yellow", "red"), name = "Temp (°C)") +
  scale_shape_manual(values = c(15, 16, 17, 18), na.translate=FALSE, name="Conc (ppb)") +
  stat_regline_equation(aes(label=paste(..eq.label..)), 
                        color="red", size=4, label.x = 1955.5, label.y = 363) +
  stat_regline_equation(aes(label=paste(..rr.label..)), 
                        color="red", size=4, label.x = 1955.5, label.y = 326) +
  stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
                  aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
                  color="red", size=4, label.x = 0.054, label.y = 0.72) +
  theme_bw() +
  theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
        axis.title = element_text(size = 10, face="bold"),
        axis.text = element_text(size = 10),
        legend.key.width = unit(0.3, "cm"),
        legend.key.height = unit(0.4, "cm"),
        legend.title = element_text(size=10, face="bold", hjust = 0.5),
        legend.justification = "center",
        legend.text = element_text(size=10),
        legend.spacing.x = unit(0.25, "cm"),
        legend.background = element_rect(color="black"),
        legend.box = "vertical", 
        legend.position = "right",
        panel.grid.minor.x=element_blank())
```

```{r ch4 emiss by year, echo=FALSE, error=FALSE, message=FALSE, warning=FALSE}
CH4emissionsyear_plot <- dfworld2 %>%
  ggplot(aes(x = Year, y = CH4_Emissions), na.rm=TRUE) +
  ggtitle("CH4 Emissions VS Year (1970-2012)") +
  scale_x_continuous(limits = c(1969,2013), breaks = seq(1970, 2010, 10)) +
  scale_y_continuous(limits = c(47,82.9), breaks = seq(50, 80, 5)) +
  ylab("CH4 Emissions (100 m. tCO2e)") +
  geom_ribbon(aes(ymin=ch4emissyearpreds$lwr, ymax=ch4emissyearpreds$upr), fill="darkgrey", alpha=0.2) +
  geom_smooth(method="lm", color="black", size=1, linetype=2, se=FALSE) +
  geom_point(aes(y=CH4_Emissions[c(TRUE, rep(NA, 4), rep(c(TRUE,NA),18), TRUE)], color=Temperature, shape=CH4_Conclevel), size=5) +
  scale_color_manual(values=c("blue", "green3", "yellow", "red"), name = "Temp (°C)") +
  scale_shape_manual(values = c(15, 16, 17, 18), na.translate=FALSE, name="Conc (ppm)") +
  stat_regline_equation(aes(label =  paste(..eq.label..)), 
                        color="green4", size=4, label.x = 1970.4, label.y = 81.25) +
  stat_regline_equation(aes(label =  paste(..rr.label..)),
                        color="green4", size=4, label.x = 1970.4, label.y = 77.6) +
  stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
                  aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
                  color="green4", size=4, label.x = 0.075, label.y = 0.74) +
  theme_bw() +
  theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
        axis.title = element_text(size = 10, face="bold"),
        axis.text = element_text(size = 10),
        legend.key.width = unit(0.3, "cm"),
        legend.key.height = unit(0.4, "cm"),
        legend.title = element_text(size=10, face="bold", hjust = 0.5),
        legend.justification = "center",
        legend.text = element_text(size=10), 
        legend.spacing.x = unit(0.25, "cm"),
        legend.background = element_rect(color="black"),
        legend.box = "vertical", 
        legend.position = "right",
        panel.grid.minor.y=element_blank())
```

```{r n2o emiss by year, message=FALSE, warning=FALSE, echo=FALSE}
N2Oemissionsyear_plot <- dfworld2 %>%
  ggplot(aes(x = Year, y = N2O_Emissions), na.rm=TRUE) +
  ggtitle("N2O Emissions VS Year (1970-2012)") +
  scale_x_continuous(limits = c(1969,2013), breaks = seq(1970, 2010, 10)) +
  scale_y_continuous(limits = c(20,35.5), breaks = seq(20, 36, 2)) +
  ylab("N2O Emissions (100 m. tCO2e)") +
  geom_ribbon(aes(ymin=n2oemissyearpreds$lwr, ymax=n2oemissyearpreds$upr), fill="darkgrey", alpha=0.2) +
  geom_smooth(method="lm", color="black", size=1, linetype=2, se=FALSE) +
  geom_point(aes(y=N2O_Emissions[c(TRUE, rep(NA, 4), rep(c(TRUE,NA),18), TRUE)], color=Temperature, shape=N2O_Conclevel), size=5) +
  scale_color_manual(values=c("blue", "green3", "yellow", "red"), name = "Temp (°C)") +
  scale_shape_manual(values = c(15, 16, 17, 18), na.translate=FALSE, name="Conc (ppm)") +
  stat_regline_equation(aes(label =  paste(..eq.label..)),
                        color="blue", size=4, label.x = 1970.4, label.y = 34.55) +
  stat_regline_equation(aes(label =  paste(..rr.label..)),
                        color="blue", size=4, label.x = 1970.4, label.y = 33.05) +
  stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc", 
                  aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
                  color="blue", size=4, label.x = 0.075, label.y = 0.73) +
  theme_bw() +
  theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
        axis.title = element_text(size = 10, face="bold"),
        axis.text = element_text(size = 10),
        legend.key.width = unit(0.3, "cm"),
        legend.key.height = unit(0.4, "cm"),
        legend.title = element_text(size=10, face="bold", hjust = 0.5),
        legend.justification = "center",
        legend.text = element_text(size=10), 
        legend.spacing.x = unit(0.25, "cm"),
        legend.background = element_rect(color="black"),
        legend.box = "vertical", 
        legend.position = "right",
        panel.grid.minor.y=element_blank())
```

---

```{r emiss vs year subcowplots, warning=FALSE, message=FALSE, echo=TRUE}
emissionstop <- plot_grid(NULL, CO2emissionsyear_plot, NULL, nrow=1, rel_widths = c(1, 3, 1))
emissionsbottom <- plot_grid(CH4emissionsyear_plot, N2Oemissionsyear_plot, nrow=1)
```

<div style="margin-right:-50px; margin-left:-50px; margin-top:-50px;">
```{r emiss vs year cowplot, echo=TRUE, fig.height=7, fig.width=11, message=FALSE, warning=FALSE}
plot_grid(emissionstop, emissionsbottom, nrow=2)
```

</div>


# Temperature VS Time

## Enitire Dataset (1880-2019) {.flexbox .centered}
<div style="margin-top:-25px;">
<div class="center">
```{r temps by all years, warning=FALSE, message=FALSE, fig.width=8.5, fig.height=5.5, fig.align="center", echo=FALSE}
tempyear <- dftempconc %>%
  ggplot(aes(x = Year, y = Land_Ocean_Temp)) +
  ggtitle("Temperature VS Year (1880-2019)") +
  scale_x_continuous(limits=c(1880,2019), breaks = seq(1880, 2020, 20)) +
  scale_y_continuous(limits = c(13.11, 14.9), breaks = seq(13.2, 15, 0.4)) +
  ylab("Land-Ocean Temperature (°C)") +
  geom_smooth(method="lm", color="black", size=1, linetype=2, se=FALSE) +
  geom_ribbon(aes(ymin=tempintpreds$lwr, ymax=tempintpreds$upr), fill="darkgrey", alpha=0.2) +
  geom_point(size=3, color="mediumvioletred") +
  stat_regline_equation(aes(label =  paste(..eq.label..)),
                        color="mediumvioletred", label.x = 1881, label.y = 14.66, size=5) +
  stat_regline_equation(aes(label =  paste(..rr.label..)),
                        color="mediumvioletred", label.x = 1881, label.y = 14.51, size=5) +
  stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
                  aes(label = paste("p = ", signif(..p.value.., digits=3), sep = "")),
                  color="mediumvioletred", size=5, label.x = 0.052, label.y = 0.68) +
  theme_bw() +
  theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"), 
        axis.title = element_text(size = 12, face="bold"), 
        axis.text = element_text(size = 11),
        legend.key.height = unit(1, "cm"),
        legend.title = element_text(size=10, face="bold", hjust = 0.5),
        legend.text = element_text(size=10),
        legend.position = "right")
tempyear
```

</div>
</div>


## By Intervals
```{r temperature intervals, message=FALSE, warning=FALSE, echo=FALSE}
# int1 is from 1880-1935
dftempyear1 <- filter(dftempconc, Year <= 1935)
yearint1 <- tibble(Year = dftempyear1$Year)
tempint1lm <- lm(Land_Ocean_Temp ~ Year, data = dftempyear1, na.action = na.exclude)
tempint1preds <- as_tibble(predict(tempint1lm, newdata=yearint1, interval="predict", level=0.95)) %>%
  mutate(Year = yearint1$Year) %>%
  select(Year, everything())

# int2 is from 1936 to 1979
dftempyear2 <- filter(dftempconc, Year > 1935 & Year < 1980)
yearint2 <- tibble(Year = dftempyear2$Year)
tempint2lm <- lm(Land_Ocean_Temp ~ Year, data = dftempyear2, na.action = na.exclude)
tempint2preds <- as_tibble(predict(tempint2lm, newdata=yearint2, interval="predict", level=0.95)) %>%
  mutate(Year = yearint2$Year) %>%
  select(Year, everything())

# int3 is from 1980-2019
dftempyear3 <- filter(dftempconc, Year >= 1980)
yearint3 <- tibble(Year = dftempyear3$Year)
tempint3lm <- lm(Land_Ocean_Temp ~ Year, data = dftempyear3, na.action = na.exclude)
tempint3preds <- as_tibble(predict(tempint3lm, newdata=yearint3, interval="predict", level=0.95)) %>%
  mutate(Year = yearint3$Year) %>%
  select(Year, everything())
```

```{r early trends, warning=FALSE, message=FALSE, echo=FALSE}
tempyear1plot <- dftempyear1 %>%
  ggplot(aes(x = Year, y = Land_Ocean_Temp), na.rm = TRUE) +
  ggtitle("Temperature VS Year (1880-1935)") +
  scale_x_continuous(limits = c(1880, 1935), breaks = seq(1880, 1930, 10)) +
  scale_y_continuous(limits = c(13.43, 14.96), breaks = seq(13.4, 15, 0.4)) +
  ylab("Land-Ocean Temperature (°C)") +
  geom_point() +
  geom_smooth(method="lm", color="red", size=1, se=FALSE) +
  geom_ribbon(aes(ymin=tempint1preds$lwr, ymax=tempint1preds$upr), fill="red", alpha=0.2) +
  stat_regline_equation(aes(label =  paste(..eq.label..)),
                        color="red", label.x = 1881, label.y = 14.93, size=4) +
  stat_regline_equation(aes(label =  paste(..rr.label..)),
                        color="red", label.x = 1881, label.y = 14.82, size=4) +
  stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
                  aes(label = paste("p = ", signif(..p.value.., digits=3), sep = "")),
                  color="red", size=4, label.x = 0.062, label.y = 0.81) +
  theme_bw() +
  theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
        axis.title = element_text(size = 10, face="bold"),
        axis.text = element_text(size = 10),
        legend.position="none")
```

```{r middle trends, warning=FALSE, message=FALSE, echo=FALSE}
tempyear2plot <- dftempyear2 %>%
  ggplot(aes(x = Year, y = Land_Ocean_Temp), na.rm = TRUE) +
  ggtitle("Temperature VS Year (1936-1979)") +
  scale_x_continuous(limits = c(1936, 1979), breaks = seq(1935, 1980, 10)) +
  scale_y_continuous(limits = c(13.43, 14.96), breaks = seq(13.4, 15, 0.4)) +
  ylab("Land-Ocean Temperature (°C)") +
  geom_point() +
  geom_smooth(method="lm", color="green4", size=1, se=FALSE) +
  geom_ribbon(aes(ymin=tempint2preds$lwr, ymax=tempint2preds$upr), fill="green4", alpha=0.2) +
  stat_regline_equation(aes(label =  paste(..eq.label..)),
                        color="green4", label.x = 1936.5, label.y = 14.93, size=4) +
  stat_regline_equation(aes(label =  paste(..rr.label..)),
                        color="green4", label.x = 1936.5, label.y = 14.82, size=4) +
  stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
                  aes(label = paste("p = ", signif(..p.value.., digits=3), sep = "")),
                  color="green4", size=4, label.x = 0.058, label.y = 0.81) +
  theme_bw() +
  theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
        axis.title = element_text(size = 10, face="bold"),
        axis.text = element_text(size = 10),
        legend.position="none")
```

```{r recent trends, warning=FALSE, message=FALSE, echo=FALSE}
tempyear3plot <- dftempyear3 %>%
  ggplot(aes(x = Year, y = Land_Ocean_Temp), na.rm = TRUE) +
  ggtitle("Temperature VS Year (1980-2019)") +
  scale_x_continuous(limits = c(1980, 2019), breaks = seq(1980, 2020, 10)) +
  scale_y_continuous(limits = c(13.43, 14.96), breaks = seq(13.4, 15, 0.4)) +
  ylab("Land-Ocean Temperature (°C)") +
  geom_point() +
  geom_smooth(method="lm", color="blue", size=1, se=FALSE) +
  geom_ribbon(aes(ymin=tempint3preds$lwr, ymax=tempint3preds$upr), fill="blue", alpha=0.2) +
  stat_regline_equation(aes(label =  paste(..eq.label..)),
                        color="blue", label.x = 1980.5, label.y = 14.93, size=4) +
  stat_regline_equation(aes(label =  paste(..rr.label..)),
                        color="blue", label.x = 1980.5, label.y = 14.82, size=4) +
  stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
                  aes(label = paste("p = ", signif(..p.value.., digits=3), sep = "")),
                  color="blue", size=4, label.x = 0.058, label.y = 0.81) +
  theme_bw() +
  theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
        axis.title = element_text(size = 10, face="bold"),
        axis.text = element_text(size = 10),
        legend.position="none")
```

<div style="margin-right:-50px; margin-left:-50px;">
<div class="center">
```{r temp int plots, fig.width=11, fig.height=4, fig.align="center", message=FALSE, warning=FALSE, echo=FALSE}
plot_grid(tempyear1plot, tempyear2plot, tempyear3plot, ncol=3)
```

</div>
</div>


# Predicting Future Temperatures {.flexbox .vcenter}
```{r future temps data, warning=FALSE, message=FALSE, echo=FALSE}
predsYear <- tibble(Year = c(2020:2200))
future1880lm <- as_tibble(predict(tempyear_lm, newdata = predsYear, interval="predict", level=0.95))  %>%
  mutate(Year = predsYear$Year, Predicting_Model = c("1880-2019 lm")) %>%
  select(Year, Predicting_Model, everything())
future1980lm <- as_tibble(predict(tempint3lm, newdata = predsYear, interval="predict", level=0.95))  %>%
  mutate(Year = predsYear$Year, Predicting_Model = c("1980-2019 lm")) %>%
  select(Year, Predicting_Model, everything())
futuretemps <- future1880lm %>%
  full_join(future1980lm) %>%
  arrange(Year)
temps1880trends <- tempintpreds %>%
  mutate(Predicting_Model = "1880-2019 lm")
temps1980trends <- tempint3preds %>%
  mutate(Predicting_Model = "1980-2019 lm")
temps <- tibble(Year = dftempconc$Year, Temperature = dftempconc$Land_Ocean_Temp)
tempsboth <- futuretemps %>%
  full_join(temps1880trends) %>%
  full_join(temps1980trends) %>%
  full_join(temps, by="Year") %>%
  arrange(Year)
```

---

<div style="margin-top:-25px;">
```{r past and future temps plot, fig.width=9, fig.height=6, fig.align="center",  fig.pos="hv", message=FALSE, warning=FALSE, echo=FALSE}
futureplot <- tempsboth %>%
  ggplot(aes(x = Year, y = fit, color=Predicting_Model)) +
  ggtitle("Predicted Future Land-Ocean Temperatures", subtitle = "Historic Trends VS Recent Trends") +
  scale_x_continuous(limit = c(1880,2200), breaks = seq(1880, 2200, 40)) +
  scale_y_continuous(limit = c(13.11,18.49), breaks = seq(13.5, 18.5, 0.5)) +
  ylab("Predicted Temperature (°C)") +
  labs(fill="Model", color="Model") +
  geom_line(size=1.2) +
  geom_line(aes(y=lwr, color=Predicting_Model), linetype = 5, size=1, show.legend=FALSE) +
  geom_line(aes(y=upr, color=Predicting_Model), linetype = 5, size=1, show.legend=FALSE) +
  geom_ribbon(aes(ymin=lwr, ymax=upr, fill=Predicting_Model), alpha=0.2) +
  geom_hline(yintercept=14.85, linetype = 3, color = "black", size = 1) +
  geom_hline(yintercept=16.85, linetype = 3, color = "black", size = 1) +
  geom_point(aes(y=Temperature)) +
  theme_bw() +
  theme(plot.title = element_text(size = 20, hjust = 0.5, face = "bold"), 
        plot.subtitle = element_text(size = 16, hjust = 0.5),
        axis.title = element_text(size = 15, face="bold"), 
        axis.text = element_text(size = 12),
        legend.title = element_text(size=15, face="bold", hjust = 0.5), 
        legend.text = element_text(size=12), 
        legend.position = c(0.16, 0.82),
        legend.background = element_rect(color="black", fill = "gainsboro"), 
        panel.grid.minor.y=element_blank())
futureplot
```

</div>


# Ranking Models By $R^{2}$ 
```{r lm models not graphed, message=FALSE, warning=FALSE, echo=FALSE}
## Temperature VS Concentration
co2conclm <- lm(Land_Ocean_Temp ~ dftempconc2$CO2_Concentration, data = dftempconc2, na.action = na.exclude)
ch4conclm <- lm(Land_Ocean_Temp ~ CH4_Concentration, data = dftempconc2, na.action = na.exclude)
n2oconclm <- lm(Land_Ocean_Temp ~ N2O_Concentration, data = dftempconc3, na.action = na.exclude)

## Temperature VS Emissions 
tempco2emisslm <- lm(Land_Ocean_Temp ~ CO2_Emissions, data = dfworld, na.action = na.exclude)
tempch4emisslm <- lm(Land_Ocean_Temp ~ CH4_Emissions, data = dfworld2, na.action = na.exclude)
tempn2oemisslm <- lm(Land_Ocean_Temp ~ N2O_Emissions, data = dfworld2, na.action = na.exclude)

## Concentration VS Emissions 
co2emissconclm <- lm(CO2_Concentration ~ CO2_Emissions, data = dfworld, na.action = na.exclude)
ch4emissconclm <- lm(CH4_Concentration ~ CH4_Emissions, data = dfworld2, na.action = na.exclude)
n2oemissconclm <- lm(dfworld2$N2O_Concentration ~ dfworld2$N2O_Emissions, data = dfworld2, na.action = na.exclude)

## Emissions VS Population 
co2emisspoplm <- lm(CO2_Emissions ~ Population, data = dfworld, na.action = na.exclude)
ch4emisspoplm <- lm(CH4_Emissions ~ Population, data = dfworld2, na.action = na.exclude)
n2oemisspoplm <- lm(N2O_Emissions ~ Population, data = dfworld2, na.action = na.exclude)

## Temperature VS Population
temppoplm <- lm(Land_Ocean_Temp ~ Population, data = dfworld, na.action = na.exclude)

## Concentration VS Population 
co2concpoplm <- lm(CO2_Concentration ~ Population, data = dfworld, na.action = na.exclude)
ch4concpoplm <- lm(CH4_Concentration ~ Population, data = dfworld, na.action = na.exclude)
n2oconcpoplm <- lm(N2O_Concentration ~ Population, data = dfworld, na.action = na.exclude)

## Concentration VS Concentration
co2concch4lm <- lm(CO2_Concentration ~ CH4_Concentration, data = dftempconc2, na.action = na.exclude)
co2concn2olm <- lm(CO2_Concentration ~ N2O_Concentration, data = dftempconc2, na.action = na.exclude)
ch4concco2lm <- lm(CH4_Concentration ~ CO2_Concentration, data = dftempconc2, na.action = na.exclude)
ch4concn2olm <- lm(CH4_Concentration ~ N2O_Concentration, data = dftempconc2, na.action = na.exclude)
n2oconcco2lm <- lm(N2O_Concentration ~ CO2_Concentration, data = dftempconc2, na.action = na.exclude)
n2oconcch4lm <- lm(N2O_Concentration ~ CH4_Concentration, data = dftempconc2, na.action = na.exclude)

## Emissions VS Emissions
co2emissch4lm <- lm(CO2_Emissions ~ CH4_Emissions, data = dfworld2, na.action = na.exclude)
co2emissn2olm <- lm(CO2_Emissions ~ N2O_Emissions, data = dfworld2, na.action = na.exclude)
ch4emissco2lm <- lm(CH4_Emissions ~ CO2_Emissions, data = dfworld2, na.action = na.exclude)
ch4emissn2olm <- lm(CH4_Emissions ~ N2O_Emissions, data = dfworld2, na.action = na.exclude)
n2oemissco2lm <- lm(N2O_Emissions ~ CO2_Emissions, data = dfworld2, na.action = na.exclude)
n2oemissch4lm <- lm(N2O_Emissions ~ CH4_Emissions, data = dfworld2, na.action = na.exclude)
```

## Top 10 Models 
<div style="margin-top:-25px;">
|           Model                                 | $R^{2}$ | Time Period  |
| ------------------------------------------      | ------- | ------------ | 
| $Population$ ~ $Year$                           | $0.998$ | 1955-2017    |
| $Concentrations: CO_{2}$ ~ $N_{2}O$             | $0.997$ | 1880-2016    |
| $N_{2}O\ Concentration$ ~ $Population$          | $0.992$ | 1955-2017    |
| $CO_{2}\ Concentration$ ~ $Population$          | $0.988$ | 1955-2017    |
| $CO_{2}\ Emissions$ ~ $Year$                    | $0.974$ | 1955-2017    |
| $CO_{2}\ Concentration$ ~ $CO_{2}\ Emissions$   | $0.971$ | 1955-2017    |
| $CO_{2}\ Emissions$ ~ $Population$              | $0.971$ | 1955-2017    |
| $CH_{4}\ Concentration$ ~ $Year$                | $0.966$ | 1880-2018    |
| $Emissions: CO_{2}$ ~ $CH_{4}$                  | $0.934$ | 1970-2012    |
| $N_{2}O\ Concentration$ ~ $LandOceanTemp$       | $0.912$ | 1880-2018    |
| $CH_{4}\ Emissions$ ~ $Year$                    | $0.911$ | 1970-2012    |
</div>

## Miscellaneous Models 
<div style="margin-top:-25px;">
|           Model                                 | $R^{2}$ | Time Period  |
| ------------------------------------------      | ------- | ------------ | 
| $Population$ ~ $Year$                           | $0.998$ | 1955-2017    |
| $LandOceanTemp$ ~ $Population$                  | $0.871$ | 1955-2017    |
| $LandOceanTemp(Recent)$ ~ $Year$                | $0.834$ | 1980-2019    |
| $LandOceanTemp$ ~ $Year$                        | $0.768$ | 1880-2019    |
</div>

## CO2 Models 
<div style="margin-top:-25px;">
|           Model                                 | $R^{2}$ | Time Period  |
| ------------------------------------------      | ------- | ------------ | 
| $CO_{2}\ Concentration$ ~ $Population$          | $0.988$ | 1955-2017    |
| $CO_{2}\ Emissions$ ~ $Year$                    | $0.974$ | 1955-2017    |
| $CO_{2}\ Concentration$ ~ $CO_{2}\ Emissions$   | $0.971$ | 1955-2017    |
| $CO_{2}\ Emissions$ ~ $Population$              | $0.971$ | 1955-2017    |
| $CO_{2}\ Concentration$ ~ $LandOceanTemp$       | $0.885$ | 1880-2018    |
| $CO_{2}\ Concentration$ ~ $Year$                | $0.855$ | 1880-2018    |
| $CO_{2}\ Emissions$ ~ $LandOceanTemp$           | $0.837$ | 1955-2017    |
</div>

## CH4 Models 
<div style="margin-top:-25px;">
|           Model                                 | $R^{2}$ | Time Period  |
| ------------------------------------------      | ------- | ------------ | 
| $CH_{4}\ Concentration$ ~ $Year$                | $0.966$ | 1880-2018    |
| $CH_{4}\ Emissions$ ~ $Year$                    | $0.911$ | 1970-2012    |
| $CH_{4}\ Emissions$ ~ $Population$              | $0.909$ | 1970-2012    |
| $CH_{4}\ Concentration$ ~ $Population$          | $0.874$ | 1955-2017    |
| $CH_{4}\ Concentration$ ~ $LandOceanTemp$       | $0.803$ | 1880-2018    |
| $CH_{4}\ Emissions$ ~ $LandOceanTemp$           | $0.780$ | 1970-2012    |
| $CH_{4}\ Concentration$ ~ $CH_{4}\ Emissions$   | $0.706$ | 1970-2012    |
</div>

## N2O Models 
<div style="margin-top:-25px;">
|           Model                                 | $R^{2}$ | Time Period  |
| ------------------------------------------      | ------- | ------------ | 
| $N_{2}O\ Concentration$ ~ $Population$          | $0.992$ | 1955-2017    |
| $N_{2}O\ Concentration$ ~ $LandOceanTemp$       | $0.912$ | 1880-2018    |
| $N_{2}O\ Concentration$ ~ $Year$                | $0.900$ | 1880-2016    |
| $N_{2}O\ Emissions$ ~ $Year$                    | $0.754$ | 1970-2012    |
| $N_{2}O\ Emissions$ ~ $Population$              | $0.751$ | 1970-2012    |
| $N_{2}O\ Emissions$ ~ $LandOceanTemp$           | $0.703$ | 1970-2012    |
| $N_{2}O\ Concentration$ ~ $N_{2}O\ Emissions$   | $0.649$ | 1970-2012    |
</div>

## Concentration Models 
<div style="margin-top:-25px;">
|           Concentrataion Models                 | $R^{2}$ | Time Period  |
| ------------------------------------------      | ------- | ------------ | 
| $CO_{2}$ ~ $N_{2}O$                             | $0.997$ | 1880-2016    |
| $CH_{4}$ ~ $N_{2}O$                             | $0.907$ | 1880-2016    |
| $CO_{2}$ ~ $CH_{4}$                             | $0.859$ | 1880-2018    |
</div>

## Emissions Models 
<div style="margin-top:-25px;">
|           Emissions Models                      | $R^{2}$ | Time Period  |
| ------------------------------------------      | ------- | ------------ | 
| $CO_{2}$ ~ $CH_{4}$                             | $0.934$ | 1970-2012    |
| $CH{4}$ ~ $CO_{2}$                              | $0.807$ | 1970-2012    |
| $CO_{2}$ ~ $N_{2}O$                             | $0.639$ | 1970-2012    |
</div>


# Discussion, Limitations, Suggestions, Conclusion

## Discussion
<div class="red"> 
- <strong>How have gas emissions, concentration, temperatures, and the population changed over time?</strong>  
</div>
<div class="blue"> 
- <strong>Are gas emissions, concentrations, and the population related to temperature?</strong>
</div>
<div class="green2"> 
- <strong>Will global temperatures increase in the future? If so, by how much</strong>
    - Recent trends predict temperature will increase by 2°C around the year 2150 and by 3°C by 2200
    - Overall trends since 1880 predict a 1°C increase by 2200
</div>

--- 

<center>
<div class="FireBrick"> 
<p style="font-size:50px">
<strong>_Can Real Progress Be Made_</strong>
</p>
<p style="font-size:50px">
<strong>_If The Population Keeps_</strong>
</p>
<p style="font-size:50px">
<strong>_Increasing?_</strong>
</p>
</div>
</center>

## Limitations
<div class="SlateGrey">
- Correlations do not imply causations
- The chemistry involving GHGs was not analyzed
</div>
<center>
![](chemistry.jpeg)
</center>

## Suggestions
<div class="DarkMagenta"> 
- This study provides the statistical analysis that chemist can uses moving forward
</div>

<div class="Maroon"> 
- <strong>Future Research</strong>
    - Should consider the chemical background  
    - Determine the best strategies to decrease CO2 emissions
</div>

## Conclusion
<div class="black"> 
- Global Warming is a serious threat facilitated by GHGs. 
- Steps should be implemented to reduce GHG emissions
- Based on the strengths of linear models, reducing CO2 emissions should be prioritized
</div>
<center>
![](conclusion.jpeg)
</center>

## References
<div style="margin-top:-25px;">
<p style="font-size:10px">
- “Climate Change Indicators: Greenhouse Gases.” EPA, Environmental Protection Agency, 22 Feb. 2017, www.epa.gov/climate-indicators/greenhouse-gases.

- European Commission, Joint Research Centre (JRC)/Netherlands Environmental Assessment Agency (PBL). Emission Database for Global Atmospheric Research (EDGAR): http://edgar.jrc.ec.europa.eu/

- European Environment Agency (EEA) & Advanced Global Atmospheric Gases Experiment (AGAGE). https://www.eea.europa.eu/data-and-maps/data/external/agage-measurements.

- European Environment Agency (EEA) & National Oceanic and Atmospheric Administration (NOAA). https://www.eea.europa.eu/data-and-maps/data/external/agage-measurements. 

- Global Carbon Project. (2019). CO2 Emissions. http://www.globalcarbonatlas.org/en/CO2-emissions

- Hannah Ritchie and Max Roser (2020) - "CO₂ and Greenhouse Gas Emissions". Published online at OurWorldInData.org. https://ourworldindata.org/co2-and-other-greenhouse-gas-emissions'

- IPCC, 2013: Climate Change 2013: The Physical Science Basis. Contribution of Working Group I to the Fifth Assessment Report of the Intergovernmental Panel on Climate Change [Stocker, T.F., D. Qin, G.-K. Plattner, M. Tignor, S.K. Allen, J. Boschung, A. Nauels, Y. Xia, V. Bex and P.M. Midgley (eds.)]. Cambridge University Press, Cambridge, United Kingdom and New York, NY, USA.

- NOAA National Centers for Environmental information, Climate at a Glance: Global Time Series, published April 2020, retrieved on April 20, 2020 from https://www.ncdc.noaa.gov/cag/

- Triola, M. F. (2014) Elementary Stataistics (12th edition). Pearson Inc.
</p>
</div>



```{r emiss by year legend, message=FALSE, warning=FALSE, include=FALSE}
# legend_co2emissions <- get_legend(CO2emissionsyear_plot + 
#                                            theme(
#                                              legend.key.width = unit(0.4, "cm"),
#                                              legend.key.height = unit(0.4, "cm"),
#                                              legend.title = element_text(size=10, face="bold", hjust = 0.5),
#                                              legend.justification = "top",
#                                              legend.text = element_text(size=10), 
#                                              legend.spacing.x = unit(0.3, "cm"),
#                                              legend.background = element_rect(color="black", fill = "gainsboro"),
#                                              legend.box = "horizontal", 
#                                              legend.position = c(0.5, 0.8)
#                                              )
#                                   ) 
# legend_co2emissions <- as_ggplot(legend_co2emissions)
# legend_ch4n2oemissions <- get_legend(CH4emissionsyear_plot + 
#                                            theme(
#                                              legend.key.width = unit(0.4, "cm"),
#                                              legend.key.height = unit(0.4, "cm"),
#                                              legend.title = element_text(size=10, face="bold", hjust = 0.5),
#                                              legend.justification = "top",
#                                              legend.text = element_text(size=10), 
#                                              legend.spacing.x = unit(0.3, "cm"),
#                                              legend.background = element_rect(color="black", fill = "gainsboro"),
#                                              legend.box = "horizontal", 
#                                              legend.position = c(0.5, 0.8)
#                                              ) 
#                                   )
# legend_emissions <- plot_grid(legend_co2emissions, legend_ch4n2oemissions, nrow=2)
```

```{r emiss vs pop lm,  warning=FALSE, message=FALSE, include=FALSE}
## Emissions VS Population {.flexbox .vcenter}
# co2emisspoplm <- lm(CO2_Emissions ~ Population, data = dfworld, na.action = na.exclude)
# co2emisspoppreds <- as_tibble(predict(co2emisspoplm, newdata=popint, interval="predict", level=0.95)) %>%
#   mutate(Population = popint$Population) %>%
#   select(Population, everything())
# 
# ch4emisspoplm <- lm(CH4_Emissions ~ Population, data = dfworld2, na.action = na.exclude)
# ch4emisspoppreds <- as_tibble(predict(ch4emisspoplm, newdata=popint2, interval="predict", level=0.95)) %>%
#   mutate(Population = popint2$Population) %>%
#   select(Population, everything())
# 
# n2oemisspoplm <- lm(N2O_Emissions ~ Population, data = dfworld2, na.action = na.exclude)
# n2oemisspoppreds <- as_tibble(predict(n2oemisspoplm, newdata=popint2, interval="predict", level=0.95)) %>%
#   mutate(Population = popint2$Population) %>%
#   select(Population, everything())
```

```{r co2 emiss by pop, message=FALSE, warning=FALSE, include=FALSE}
# CO2emisspop_plot <- dfworld %>%
#   ggplot(aes(x = Population, y = CO2_Emissions), na.rm=TRUE) +
#   ggtitle("CO2 Emissions VS Population") +
#   geom_point() +
#   geom_smooth(method="lm", color="red", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=co2emisspoppreds$lwr, ymax=co2emisspoppreds$upr), fill="red", alpha=0.2) +
#   scale_x_continuous(limits = c(2.7, 7.55), breaks = seq(3, 7.5, 1)) +
#   scale_y_continuous(limits = c(53.96,380.08), breaks = seq(60, 360, 60)) +
#   ylab("CO2 Emissions (100 m. tCO2e)") +
#   stat_regline_equation(aes(label=paste(..eq.label..)), 
#                         color="red", size=4, label.x = 2.7, label.y = 371) +
#   stat_regline_equation(aes(label=paste(..rr.label..)), 
#                         color="red", size=4, label.x = 2.7, label.y = 345) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="red", size=4, label.x = 0.046, label.y = 0.79) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none")
#         #panel.grid.minor.x=element_blank())
# CO2emisspop_plot
```

```{r ch4 emiss by pop, message=FALSE, warning=FALSE, include=FALSE}
# CH4emisspop_plot <- dfworld2 %>%
#   ggplot(aes(x = Population, y = CH4_Emissions), na.rm=TRUE) +
#   ggtitle("CH4 Emissions VS Population") +
#   geom_point() +
#   geom_smooth(method="lm", color="green4", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=ch4emisspoppreds$lwr, ymax=ch4emisspoppreds$upr), fill="green4", alpha=0.2) +
#   scale_x_continuous(limits = c(3.63, 7.13), breaks = seq(4, 7, 1)) +
#   scale_y_continuous(limits = c(48,82.28), breaks = seq(50, 80, 5)) +
#   ylab("CH4 Emissions (100 m. tCO2e)") +
#   stat_regline_equation(aes(label =  paste(..eq.label..)), 
#                         color="green4", size=4, label.x = 3.63, label.y = 81.25) +
#   stat_regline_equation(aes(label =  paste(..rr.label..)),
#                         color="green4", size=4, label.x = 3.63, label.y = 78.75) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="green4", size=4, label.x = 0.044, label.y = 0.813) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.49, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none",
#         panel.grid.minor.y=element_blank())
```

```{r n2o emiss by pop, message=FALSE, warning=FALSE, include=FALSE}
# N2Oemisspop_plot <- dfworld2 %>%
#   ggplot(aes(x = Population, y = N2O_Emissions), na.rm=TRUE) +
#   ggtitle("N2O Emissions VS Population") +
#   geom_point() +
#   geom_smooth(method="lm", color="blue", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=n2oemisspoppreds$lwr, ymax=n2oemisspoppreds$upr), fill="blue", alpha=0.2) +
#   scale_x_continuous(limits = c(3.63, 7.13), breaks = seq(4, 7, 1)) +
#   scale_y_continuous(limits = c(20.69,35.41), breaks = seq(20, 36, 2)) +
#   ylab("N2O Emissions (100 m. tCO2e)") +
#   stat_regline_equation(aes(label =  paste(..eq.label..)),
#                         color="blue", size=4, label.x = 3.63, label.y = 34.53) +
#   stat_regline_equation(aes(label =  paste(..rr.label..)),
#                         color="blue", size=4, label.x = 3.63, label.y = 33.53) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc", 
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="blue", size=4, label.x = 0.044, label.y = 0.795) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none",
#         panel.grid.minor.y=element_blank())
```

```{r emiss vs pop plots, warning=FALSE, message=FALSE, include=FALSE, fig.align="center", fig.height=3.9, fig.width=11.5,  fig.pos="hv"}
# plot_grid(CO2emisspop_plot, CH4emisspop_plot, N2Oemisspop_plot, ncol = 3)
```

```{r conc VS pop lm,  warning=FALSE, message=FALSE, echo=FALSE}
## Concentration VS Population {.flexbox .vcenter}
# dfworld3 <- filter(dfworld, Year <= 2016)
# popint3 <- tibble(Population = dfworld3$Population)
# co2concpoplm <- lm(CO2_Concentration ~ Population, data = dfworld, na.action = na.exclude)
# co2concpoppreds <- as_tibble(predict(co2concpoplm, newdata=popint, interval="predict", level=0.95)) %>%
#   mutate(Population = popint$Population) %>%
#   select(Population, everything())
# 
# ch4concpoplm <- lm(CH4_Concentration ~ Population, data = dfworld, na.action = na.exclude)
# ch4concpoppreds <- as_tibble(predict(ch4concpoplm, newdata=popint, interval="predict", level=0.95)) %>%
#   mutate(Population = popint$Population) %>%
#   select(Population, everything())
# 
# n2oconcpoplm <- lm(N2O_Concentration ~ Population, data = dfworld3, na.action = na.exclude)
# n2oconcpoppreds <- as_tibble(predict(n2oconcpoplm, newdata=popint3, interval="predict", level=0.95)) %>%
#   mutate(Population = popint3$Population) %>%
#   select(Population, everything())
```

```{r co2 conc VS pop, message=FALSE, warning=FALSE, include=FALSE}
# CO2concpop_plot <- dfworld %>%
#   ggplot(aes(x = Population, y = CO2_Concentration), na.rm=TRUE) +
#   ggtitle("CO2 Concentration VS Population") +
#   geom_point() +
#   geom_smooth(method="lm", color="red", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=co2concpoppreds$lwr, ymax=co2concpoppreds$upr), fill="red", alpha=0.2) +
#   scale_x_continuous(limits = c(2.7, 7.55), breaks = seq(3, 7.5, 1)) +
#   scale_y_continuous(limits = c(302.3,405.05), breaks = seq(300, 410, 20)) +
#   ylab("CO2 Concentration (ppm)") +
#   stat_regline_equation(aes(label=paste(..eq.label..)), 
#                         color="red", size=4, label.x = 2.78, label.y = 394) +
#   stat_regline_equation(aes(label=paste(..rr.label..)), 
#                         color="red", size=4, label.x = 2.78, label.y = 385.5) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="red", size=4, label.x = 0.063, label.y = 0.72) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none")
#         #panel.grid.minor.x=element_blank())
```

```{r ch4 conc VS pop, message=FALSE, warning=FALSE, include=FALSE}
# CH4concpop_plot <- dfworld %>%
#   ggplot(aes(x = Population, y = CH4_Concentration), na.rm=TRUE) +
#   ggtitle("CH4 Concentration VS Population") +
#   geom_point() +
#   scale_x_continuous(limits = c(2.7, 7.55), breaks = seq(3, 7.5, 1)) +
#   scale_y_continuous(limits = c(1207,2021.79), breaks = seq(1300, 1900, 200)) +
#   ylab("CH4 Concentration (ppb)") +
#   geom_smooth(method="lm", color="green4", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=ch4concpoppreds$lwr, ymax=ch4concpoppreds$upr), fill="green4", alpha=0.2) +
#   stat_regline_equation(aes(label=paste(..eq.label..)), 
#                         color="green4", size=4, label.x = 2.78, label.y = 1925) +
#   stat_regline_equation(aes(label=paste(..rr.label..)), 
#                         color="green4", size=4, label.x = 2.78, label.y = 1850) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="green4", size=4, label.x = 0.06, label.y = 0.69) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none")
```

```{r n2o conc VS pop, message=FALSE, warning=FALSE, include=FALSE}
# N2Oconcpop_plot <- dfworld3 %>%
#   ggplot(aes(x = Population, y = N2O_Concentration), na.rm=TRUE) +
#   ggtitle("N2O Concentration VS Population") +
#   geom_point() +
#   scale_x_continuous(limits = c(2.7, 7.47), breaks = seq(3, 7.5, 1)) +
#   scale_y_continuous(limits = c(284.6,329.81), breaks = seq(290, 330, 10)) +
#   ylab("N2O Concentration (ppb)") +
#   geom_smooth(method="lm", color="blue", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=n2oconcpoppreds$lwr, ymax=n2oconcpoppreds$upr), fill="blue", alpha=0.2) +
#   stat_regline_equation(aes(label =  paste(..eq.label..)),
#                         color="blue", size=4, label.x = 2.8, label.y = 326.8) +
#   stat_regline_equation(aes(label =  paste(..rr.label..)),
#                         color="blue", size=4, label.x = 2.8, label.y = 322.6) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc", 
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="blue", size=4, label.x = 0.064, label.y = 0.74) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none")
```

```{r conc vs pop plots, warning=FALSE, message=FALSE, include=FALSE, fig.align="center", fig.height=3.9, fig.width=11.5,  fig.pos="hv"}
# plot_grid(CO2concpop_plot, CH4concpop_plot, N2Oconcpop_plot, ncol = 3)
```

```{r population lm, warning=FALSE, message=FALSE, echo=FALSE}
## Temperature VS Population
# temppoplm <- lm(Land_Ocean_Temp ~ Population, data = dfworld, na.action = na.exclude)
# temppoppreds <- as_tibble(predict(temppoplm, newdata=popint, interval="predict", level=0.95)) %>%
#   mutate(Population = popint$Population) %>%
#   select(Population, everything())
```

```{r temperature by pop, eval=FALSE, fig.align="center", fig.height=5.5, fig.width=8.5, message=FALSE, warning=FALSE, include=FALSE}
# temppopplot <- dfworld %>%
#   ggplot(aes(x = Population, y = Land_Ocean_Temp)) +
#   ggtitle("Temperature VS Population (1955-2017)") +
#   geom_point() +
#   scale_x_continuous(limits=c(2.77,7.55), breaks = seq(2.8, 7.6, 0.4)) +
#   xlab("Population in Billions") +
#   scale_y_continuous(limits = c(13.58, 14.91), breaks = seq(13.6, 15, 0.4)) +
#   ylab("Land-Ocean Temperature (°C)") +
#   geom_smooth(method="lm", color="orange4", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=temppoppreds$lwr, ymax=temppoppreds$upr), fill="orange4", alpha=0.2) +
#   stat_regline_equation(aes(label =  paste(..eq.label..)),
#                         color="orange4", size=5, label.x = 2.83, label.y = 14.75) +
#   stat_regline_equation(aes(label =  paste(..rr.label..)),
#                         color="orange4", size=5, label.x = 2.83, label.y = 14.65) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x),
#                   geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=3), sep = "")),
#                   color="orange4", size=5, label.x = 0.059, label.y = 0.72) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 14, hjust = 0.5, face = "bold"), 
#         axis.title = element_text(size = 12, face="bold"),
#         axis.text = element_text(size = 11),
#         legend.position = "none",
#         panel.grid.minor.x=element_blank())
# temppopplot
```

```{r conc vs emiss lm,  warning=FALSE, message=FALSE, include=FALSE}
## Concentration VS Emissions {.flexbox .vcenter}
# co2emissconclm <- lm(CO2_Concentration ~ CO2_Emissions, data = dfworld, na.action = na.exclude)
# co2emissconcpreds <- as_tibble(predict(co2emissconclm, newdata=co2emissint, interval="predict", level=0.95)) %>%
#   mutate(CO2_Emissions = co2emissint$CO2_Emissions) %>%
#   select(CO2_Emissions, everything())
# 
# ch4emissconclm <- lm(CH4_Concentration ~ CH4_Emissions, data = dfworld2, na.action = na.exclude)
# ch4emissconcpreds <- as_tibble(predict(ch4emissconclm, newdata=ch4emissint, interval="predict", level=0.95)) %>%
#   mutate(CH4_Emissions = ch4emissint$CH4_Emissions) %>%
#   select(CH4_Emissions, everything())
# 
# n2oemissconclm <- lm(dfworld2$N2O_Concentration ~ dfworld2$N2O_Emissions, data = dfworld2, na.action = na.exclude)
# n2oemissconcpreds <- as_tibble(predict(n2oemissconclm, newdata=n2oemissint, interval="predict", level=0.95)) %>%
#   mutate(N2O_Emissions = n2oemissint$N2O_Emissions) %>%
#   select(N2O_Emissions, everything())
```

```{r co2 both, message=FALSE, warning=FALSE, include=FALSE}
# CO2bothplot <- dfworld %>%
#   ggplot(aes(x = CO2_Emissions, y = CO2_Concentration), na.rm=TRUE) +
#   ggtitle("CO2: Concentration VS Emissions") +
#   geom_point() +
#   scale_x_continuous(limits = c(72.58,361.54), breaks = seq(60, 360, 60)) +
#   xlab("CO2 Emissions (100 mil. tCO2e)") +
#   scale_y_continuous(limits = c(296.3,411), breaks = seq(300, 420, 20)) +
#   ylab("CO2 Concentration (ppm)") +
#   geom_smooth(method="lm", color="red", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=co2emissconcpreds$lwr, ymax=co2emissconcpreds$upr), fill="red", alpha=0.2) +
#   stat_regline_equation(aes(label =  paste(..eq.label..)),
#                         color="red", size=4, label.x = 77.4, label.y = 393.5) +
#   stat_regline_equation(aes(label =  paste(..rr.label..)),
#                         color="red", size=4, label.x = 77.4, label.y = 385) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="red", size=4, label.x = 0.0621, label.y = 0.69) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10))
```

```{r ch4 both, include=FALSE, message=FALSE, warning=FALSE}
# CH4bothplot <- dfworld2 %>%
#   ggplot(aes(x = CH4_Emissions, y = CH4_Concentration), na.rm=TRUE) +
#   geom_point() +
#   ggtitle("CH4: Concentration VS Emission") +
#   scale_x_continuous(limits = c(51.45,80.15), breaks = seq(52, 80, 6)) +
#   xlab("CH4 Emissions (100 mil. tCO2e)") +
#   scale_y_continuous(limits = c(1398.48,1985.01), breaks = seq(1400, 2000, 100)) +
#   ylab("CH4 Concentration (ppb)") +
#   geom_smooth(method="lm", color="green4", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=ch4emissconcpreds$lwr, ymax= ch4emissconcpreds$upr), fill="green4", alpha=0.2) +
#   stat_regline_equation(aes(label =  paste(..eq.label..)),
#                         color="green4", size=4, label.x = 52.25, label.y = 1920) +
#   stat_regline_equation(aes(label =  paste(..rr.label..)),
#                         color="green4", size=4, label.x = 52.25, label.y = 1876) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="green4", size=4, label.x = 0.071, label.y = 0.73) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none")
```

```{r n2o both, message=FALSE, warning=FALSE, include=FALSE}
# N2Obothplot <- dfworld2 %>%
#   ggplot(aes(x = N2O_Emissions, y = N2O_Concentration), na.rm=TRUE) +
#   geom_point() +
#   ggtitle("N2O: Concentration VS Emission") +
#   scale_x_continuous(limits = c(22.25, 32.61), breaks = seq(21, 33, 2)) +
#   xlab("N2O Emissions (100 mil. tCO2e)") +
#   scale_y_continuous(limits = c(275.07, 333.7), breaks = seq(280, 330, 10)) +
#   ylab("N2O Concentration (ppb)") +
#   geom_smooth(method="lm", color="blue", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=n2oemissconcpreds$lwr, ymax=n2oemissconcpreds$upr), fill="blue", alpha=0.2) +
#   stat_regline_equation(aes(label =  paste(..eq.label..)),
#                         color="blue", size=4, label.x = 22.45, label.y = 326.9) +
#   stat_regline_equation(aes(label =  paste(..rr.label..)),
#                         color="blue", size=4, label.x = 22.45, label.y = 322.6) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="blue", size=4, label.x = 0.062, label.y = 0.73) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none")
```

```{r conc vs emiss plots, fig.width=11.5, fig.height=3.9, fig.align="center", fig.pos="hv", message=FALSE, warning=FALSE, include=FALSE}
# plot_grid(CO2bothplot, CH4bothplot, N2Obothplot, ncol = 3)
```

```{r temp VS emiss lm, warning=FALSE, message=FALSE, echo=FALSE}
## Temperature VS Emissions {.flexbox .vcenter}
# tempco2emisslm <- lm(Land_Ocean_Temp ~ CO2_Emissions, data = dfworld, na.action = na.exclude)
# tempco2emisspreds <- as_tibble(predict(tempco2emisslm, newdata=co2emissint, interval="predict", level=0.95)) %>%
#   mutate(CO2_Emissions = co2emissint$CO2_Emissions) %>%
#   select(CO2_Emissions, everything())
# 
# tempch4emisslm <- lm(Land_Ocean_Temp ~ CH4_Emissions, data = dfworld2, na.action = na.exclude)
# tempch4emisspreds <- as_tibble(predict(tempch4emisslm, newdata=ch4emissint, interval="predict", level=0.95)) %>%
#   mutate(CH4_Emissions = ch4emissint$CH4_Emissions) %>%
#   select(CH4_Emissions, everything())
# 
# tempn2oemisslm <- lm(Land_Ocean_Temp ~ N2O_Emissions, data = dfworld2, na.action = na.exclude)
# tempn2oemisspreds <- as_tibble(predict(tempn2oemisslm, newdata=n2oemissint, interval="predict", level=0.95)) %>%
#   mutate(N2O_Emissions = n2oemissint$N2O_Emissions) %>%
#   select(N2O_Emissions, everything())
```

```{r temp VS co2 emiss, warning=FALSE, message=FALSE, include=FALSE}
# tempCO2emissplot <- dfworld %>%
#   ggplot(aes(x = CO2_Emissions, y = Land_Ocean_Temp), na.rm = TRUE) +
#   ggtitle("Temp. VS CO2 Emissions (1955-2017)") +
#   scale_x_continuous(limits = c(72.58,361.54), breaks = seq(70, 370, 60)) + 
#   xlab("CO2 Emissions (ppm)") + 
#   scale_y_continuous(limits = c(13.53, 14.95), breaks = seq(13.6, 15, 0.4)) +
#   ylab("Land-Ocean Temperature (°C)") +
#   geom_point() +
#   geom_smooth(method="lm", color="red", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=tempco2emisspreds$lwr, ymax=tempco2emisspreds$upr), fill="red", alpha=0.2) +
#   stat_regline_equation(aes(label =  paste(..eq.label..)),
#                         color="red", size=4, label.x = 81, label.y = 14.85) +
#   stat_regline_equation(aes(label =  paste(..rr.label..)),
#                         color="red", size=4, label.x = 81, label.y = 14.71) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="red", size=4, label.x = 0.072, label.y = 0.72) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none")
```

```{r temp VS ch4 emiss, warning=FALSE, message=FALSE, include=FALSE}
# tempCH4emissplot <- dfworld2 %>%
#   ggplot(aes(x = CH4_Emissions, y = Land_Ocean_Temp), na.rm = TRUE) +
#   ggtitle("Temp. VS. CH4 Emissions (1970-2012)") +
#   scale_x_continuous(limits = c(51.45,80.15), breaks = seq(52, 80, 8)) +
#   xlab("CH4 Emissions (ppb)") +
#   scale_y_continuous(limits = c(13.53, 14.88), breaks = seq(13.8, 14.8, 0.4)) +
#   ylab("Land-Ocean Temperature (°C)") +
#   geom_point() +
#   geom_smooth(method="lm", color="green4", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=tempch4emisspreds$lwr, ymax= tempch4emisspreds$upr), fill="green4", alpha=0.2) +
#   stat_regline_equation(aes(label =  paste(..eq.label..)),
#                         color="green4", size=4, label.x = 52.3, label.y = 14.76) +
#   stat_regline_equation(aes(label =  paste(..rr.label..)),
#                         color="green4", size=4, label.x = 52.3, label.y = 14.66) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="green4", size=4, label.x = 0.072, label.y = 0.74) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none")
```

```{r temp VS n2o emiss, warning=FALSE, message=FALSE, include=FALSE}
# tempN2Oemissplot <- dfworld2 %>%
#   ggplot(aes(x = N2O_Emissions, y = Land_Ocean_Temp), na.rm = TRUE) +
#   ggtitle("Temp. VS N2O Emissions (1970-2012)") +
#   scale_x_continuous(limits = c(20.89, 32.61), breaks = seq(20, 32, 2)) +
#   xlab("N2O Emissions (ppb)") + 
#   scale_y_continuous(limits = c(13.53, 14.88), breaks = seq(13.8, 14.8, 0.4)) +
#   ylab("Land-Ocean Temperature (°C)") +
#   geom_point() +
#   geom_smooth(method="lm", color="blue", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=tempn2oemisspreds$lwr, ymax=tempn2oemisspreds$upr), fill="blue", alpha=0.2) +
#   stat_regline_equation(aes(label =  paste(..eq.label..)),
#                         color="blue", size=4, label.x = 21.1, label.y = 14.76) +
#   stat_regline_equation(aes(label =  paste(..rr.label..)),
#                         color="blue", size=4, label.x = 21.1, label.y = 14.66) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="blue", size=4, label.x = 0.062, label.y = 0.74) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none")
```

```{r temp vs emiss plots, message=FALSE, warning=FALSE, include=FALSE, fig.width=11.5, fig.height=3.9, fig.align="center",  fig.pos="hv"}
# plot_grid(tempCO2emissplot, tempCH4emissplot, tempN2Oemissplot, ncol=3)
```

```{r temp vs conc lm, warning=FALSE, message=FALSE, echo=FALSE}
## Temperature VS Concentration {.flexbox .vcenter}
# co2conclm <- lm(Land_Ocean_Temp ~ dftempconc2$CO2_Concentration, data = dftempconc2, na.action = na.exclude)
# co2concpreds <- as_tibble(predict(co2conclm, newdata=co2concint, interval="predict", level=0.95)) %>%
#   mutate(CO2_Concentration = co2concint$CO2_Concentration) %>%
#   select(CO2_Concentration, everything())
# 
# ch4conclm <- lm(Land_Ocean_Temp ~ CH4_Concentration, data = dftempconc2, na.action = na.exclude)
# ch4concpreds <- as_tibble(predict(ch4conclm, newdata=ch4concint, interval="predict", level=0.95)) %>%
#   mutate(CH4_Concentration = ch4concint$CH4_Concentration) %>%
#   select(CH4_Concentration, everything())
# 
# n2oconclm <- lm(Land_Ocean_Temp ~ N2O_Concentration, data = dftempconc3, na.action = na.exclude)
# n2oconcpreds <- as_tibble(predict(n2oconclm, newdata=n2oconcint, interval="predict", level=0.95)) %>%
#   mutate(N2O_Concentration = n2oconcint$N2O_Concentration) %>%
#   select(N2O_Concentration, everything())
```

```{r temp vs co2 conc, warning=FALSE, message=FALSE, include=FALSE}
# tempCO2 <- dftempconc2 %>%
#   ggplot(aes(x = CO2_Concentration, y = Land_Ocean_Temp), na.rm = TRUE) +
#   ggtitle("Temp VS CO2 Concentration (1880-2018)") +
#   scale_x_continuous(limits = c(287.76,408.53), breaks = seq(290, 410, 30)) + 
#   xlab("CO2 Concentration (ppm)") + 
#   scale_y_continuous(limits = c(13.24, 15.03), breaks = seq(13.4, 15, 0.4)) +
#   ylab("Land-Ocean Temperature (°C)") +
#   geom_point() +
#   geom_smooth(method="lm", color="red", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=co2concpreds$lwr, ymax=co2concpreds$upr), fill="red", alpha=0.2) +
#   stat_regline_equation(aes(label =  paste(..eq.label..)),
#                         color="red", size=4, label.x = 291, label.y = 14.86) +
#   stat_regline_equation(aes(label =  paste(..rr.label..)),
#                         color="red", size=4, label.x = 291, label.y = 14.71) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="red", size=4, label.x = 0.07, label.y = 0.725) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none")
```

```{r temp vs ch4 conc, warning=FALSE, message=FALSE, include=FALSE}
# tempCH4 <- dftempconc2 %>%
#   ggplot(aes(x = CH4_Concentration, y = Land_Ocean_Temp), na.rm = TRUE) +
#   ggtitle("Temp VS CH4 Concentration (1880-2018)") +
#   scale_x_continuous(limits = c(847.47,1857.63), breaks = seq(850, 1850, 200)) +
#   xlab("CH4 Concentration (ppb)") +
#   scale_y_continuous(limits = c(13.24, 15.03), breaks = seq(13.4, 15, 0.4)) +
#   ylab("Land-Ocean Temperature (°C)") +
#   geom_point() +
#   geom_smooth(method="lm", color="green4", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=ch4concpreds$lwr, ymax= ch4concpreds$upr), fill="green4", alpha=0.2) +
#   stat_regline_equation(aes(label =  paste(..eq.label..)),
#                         color="green4", size=4, label.x = 860, label.y = 14.86) +
#   stat_regline_equation(aes(label =  paste(..rr.label..)),
#                         color="green4", size=4, label.x = 860, label.y = 14.71) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="green4", size=4, label.x = 0.058, label.y = 0.725) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none")
```

```{r temp vs n2o conc, warning=FALSE, message=FALSE, include=FALSE}
# tempN2O <- dftempconc3 %>%
#   ggplot(aes(x = N2O_Concentration, y = Land_Ocean_Temp), na.rm = TRUE) +
#   ggtitle("Temp VS N2O Concentration (1880-2016)") +
#   scale_x_continuous(limits = c(278.19, 329.3), breaks = seq(280, 330, 10)) +
#   xlab("N2O Concentration (ppb)") + 
#   scale_y_continuous(limits = c(13.24, 15.03), breaks = seq(13.4, 15, 0.4)) +
#   ylab("Land-Ocean Temperature (°C)") +
#   geom_point() +
#   geom_smooth(method="lm", color="blue", size=1, se=FALSE) +
#   geom_ribbon(aes(ymin=n2oconcpreds$lwr, ymax=n2oconcpreds$upr), fill="blue", alpha=0.2) +
#   stat_regline_equation(aes(label =  paste(..eq.label..)),
#                         color="blue", size=4, label.x = 280.5, label.y = 14.86) +
#   stat_regline_equation(aes(label =  paste(..rr.label..)),
#                         color="blue", size=4, label.x = 280.5, label.y = 14.71) +
#   stat_fit_glance(method = 'lm', method.args = list(formula = y ~ x), geom = "text_npc",
#                   aes(label = paste("p = ", signif(..p.value.., digits=2), sep = "")),
#                   color="blue", size=4, label.x = 0.087, label.y = 0.725) +
#   theme_bw() +
#   theme(plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
#         axis.title = element_text(size = 10, face="bold"),
#         axis.text = element_text(size = 10),
#         legend.position="none")
```

```{r temp vs conc plots, message=FALSE, warning=FALSE, include=FALSE, fig.width=11.2, fig.height=3.9, fig.align="center",  fig.pos="hv"}
# plot_grid(tempCO2, tempCH4, tempN2O, ncol=3)
```
